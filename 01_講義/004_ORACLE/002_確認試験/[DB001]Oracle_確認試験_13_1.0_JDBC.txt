■JDBC(概要、PreparedStatement、SQLインジェクション)
1.
JDBCの役割として正しいものはどれか。

1. データベースの正規化を自動的に行う機能を提供する。
2. Javaのソースコードをコーディング規約に沿って自動的に修正する機能を提供する。
3. Javaのプログラムからデータベースを操作するための機能を提供する。
4. SQL文をJavaの構文で記述できるようにする機能を提供する。

正答：3
解説：
『Oracle Database』 第12章「JDBC」 / JDBCとは
JDBC（Java DataBase Connectivity）とは、Javaのプログラムでデータベースを操作するための機能を持ったAPIのことです。このAPIを利用することで、テーブル中の行の検索、登録、更新、削除をJavaのプログラムで実行することができます。したがって、選択肢3が正解です。


■JDBC(概要、PreparedStatement、SQLインジェクション)
2.
DriverManager#getConnection()メソッドの機能として正しいものはどれか。

1. 指定したデータベースに接続する。
2. 指定したテーブルに対してSQL文を実行する。
3. 指定したデータベースに新しいテーブルを作成する。
4. 指定したデータベースに新しいユーザを作成する。

正答：1
解説：
『Oracle Database』 第12章「JDBC」/ DBへの接続/切断
DriverManager#getConnection()メソッドは指定したデータベースに接続するための処理です。したがって、選択肢1が正解です。
Oracleのデータベースへ接続する場合、このメソッドの引数には「接続するデータベースのURL」、「接続するためのユーザ名」、「接続するためのパスワード」を指定します。


■JDBC(概要、PreparedStatement、SQLインジェクション)
3.
JDBCを利用した場合、データベースと接続して、SQL文の実行が終わった後に必ず実行しなければいけない処理はどれか。

1. SQL文の実行結果をコンソール上に出力する処理。
2. データベースとの接続を切断する処理。
3. 別のデータベースへ接続する処理。
4. 実行したSQL文を保存した変数の値をNULLに上書きする処理。

正答：2
解説：
『Oracle Database』 第12章「JDBC」/ DBへの接続/切断
SQL文の実行まで終わった後は必ず、Connection#close()メソッドを使用して、データベースとの接続を切断しなければなりません。
接続した状態のままですと、その後の処理によってはアプリケーションやデータベース自体のシステム停止など、致命的なトラブルにつながる危険性があります。


■JDBC(概要、PreparedStatement、SQLインジェクション)
4.
データベースに接続した後、SQL文で絞り込み検索の実行して検索結果を取得するまでには、どのような流れで処理が行われるか。以下の処理を並び替えて答えなさい。

①：PreparedStatement#executeQuery()メソッドを使用して、SQL文を実行し、検索結果の行をReultSet型の変数に代入する。
②：PreparedStatement#setString()メソッドを使用して、SQL文中のプレースホルダーに値をバインドする。
③：実行したいSQL文をString型の変数に代入する。
④：Connection#prepareStatement()メソッドを使用して、SQL文を実行するための情報（ステートメント）を作成する。

1. ② → ③ → ① → ④
2. ① → ④ → ② → ③
3. ④ → ③ → ② → ①
4. ③ → ④ → ② → ①

正答：4
解説：
『Oracle Database』 第12章「JDBC」/ 条件検索
PreparedStatementを使用して絞り込み検索を行う際には以下の流れで処理を実行する必要があります。

1. 実行したいSQL文をString型の変数に代入する。
2. Connection#prepareStatement()メソッドを使用して、SQL文を実行するための情報（ステートメント）を作成する。
3. PreparedStatement#setString()メソッドを使用して、SQL文中のプレースホルダーに値をバインドする。
4. PreparedStatement#executeQuery()メソッドを使用して、SQL文を実行し、検索結果の行をReultSet型の変数に代入する。

各工程を記述し忘れてしまうと、コンパイル中、もしくは実行中にエラーになりますので注意しましょう。


■JDBC(概要、PreparedStatement、SQLインジェクション)
5.
ResultSet#next()メソッドを1回実行したときの処理として正しいものはどれか。

1. カーソルを1行分進め、現在何行目の行を読み込んでいるかをint型の値で返す。
2. カーソルを1行分進め、次に読み込みこむ行の内容をString型の値で返す。
3. カーソルを1行分進め、次に読み込める行があるかどうかをboolean型の値で返す。
4. カーソルを1行分進め、カーソルの位置以下にある行を全て取得し、Stringの配列の値で返す。

正答：3
解説：
『Oracle Database』 第12章「JDBC」/ 全件検索
ResultSetとはSELECT文による検索結果を保存するためのクラスです。
このクラスのオブジェクト内では検索結果の行がテーブル形式で管理されています。また、今現在どの行を読み込んでいる状態かをカーソルで管理しており、カーソルの位置にある行からのみResultSet#getString()メソッドなどを使用してその各列の値を取得できます。
ResultSet#next()メソッドは、このカーソルを1つ下の行に移動させ、次の行を読み込ませる機能を持っています。もし、カーソルの移動先に行がある場合はtrueを戻り値として返します。また、行が無い場合（つまり、これ以上読み込める行が無い場合）はfalseを返します。したがって、選択肢3が正解です。


■JDBC(概要、PreparedStatement、SQLインジェクション)
6.
下記の文中の（　）内にあてはまる単語として、正しいものはどれか。

SQLインジェクションとは、アプリケーションが利用しているDBに対して、プログラマが想定していない値をアプリケーションに入力することで、不正なSQLを実行させる攻撃手法のことである。
この攻撃には、（ ① ）を使うことで対策することができる。（ ① ）を利用した場合、ユーザからの入力値は全て単純な文字列として扱われるため、どのような文字列を入力されても不正なSQL文は実行されなくなる。

1. PreparedStatement
2. ResultSet 
3. DriverManager
4. Connection

正答：1
解説：
『Oracle Database』 第12章「JDBC」/ SQLインジェクション
SQLインジェクションに関する問題です。
JDBCでのSQL文の実行にはかつてStatementというクラス（ステートメント）を使用していました。しかし、StatementはSQLインジェクションへの対策が取れていませんでした。そこで改良されたステートメントがPreparedStatementです。PreparedStatementにはバインド機能があり、入力値を単純な文字列として扱ってSQL文中に埋め込むことができます。これにより、SQLインジェクションの問題は解消されました。したがって、選択肢1が正解です。


■JDBC(概要、PreparedStatement、SQLインジェクション)
7.
PreparedStatementのexecuteUpdateについて説明しているもので、正しいものはどれか

1. 戻り値はResultSet型のオブジェクトとなっている。
2. INSERT文を実行する際に使用するメソッドである。
3. executeQueryメソッドとまったく同じ動きをするので、自由に使い分ける。
4. JDBCにおいてSQLを実行するための唯一の手段である。


正答：2
解説：
『Oracle Database』 第12章「JDBC」/ 登録
executeUpdateメソッドは更新系のSQL（つまりは登録、更新、削除）の際に利用します。
executeQueryが、SQLを実行できるメソッドとして存在していますが、大きな違いは
戻り値の型はResultSet型ではなくint型となっていることです。
したがって、選択肢2が正解です。



■JDBC(概要、PreparedStatement、SQLインジェクション)
8.
JDBCによるトランザクション管理にて説明しているもので、正しいものはどれか

1. JDBCは自動コミットモードをもっており、デフォルトの設定では自動コミットはオフにされている。
2. JDBCによるトランザクション管理は、Connection#transaction()メソッドを利用する。
3. 古いバージョンとなるojdbc6まではトランザクション管理は出来なかった。
4. ConnectionオブジェクトのsetAutoCommitメソッドにて、自動コミットモードのオンオフを切り替えられる。

正答：4
解説：
『Oracle Database』 第12章「JDBC」/ トランザクション管理
JDBCにおける自動コミットモードはデフォルトはオンになっており、INSERT文などを実行すると即時反映されます。
モードの切り替えはConnectionオブジェクトのsetAutoCommitメソッドにて実施されます。
ojdbc6などのバージョンには関係なく、実施できます。
したがって、選択肢4が正解です。


